include_guard(GLOBAL)

@PACKAGE_INIT@

set_and_check(MBASE_INFERENCE_BIN_DIR "@PACKAGE_MBASE_INFERENCE_BIN_INSTALL_DIR@")
set_and_check(MBASE_INFERENCE_LIB_DIR "@PACKAGE_MBASE_INFERENCE_LIB_INSTALL_DIR@")
set_and_check(MBASE_INFERENCE_INCLUDE_DIRS "@PACKAGE_MBASE_INFERENCE_INCLUDE_INSTALL_DIR@")

set(MBASE_INFERENCE_NAME_DESCRIPTIVE "MBASE @MBASE_INFERENCE_LIB_NAME@ library @MBASE_INFERENCE_VERSION@")

find_library(
    MBASE_INFERENCE_LIBRARIES
    NAMES mb_inference
    HINTS ${MBASE_INFERENCE_LIB_DIR}
    REQUIRED
)

include(FindPackageHandleStandardArgs)
find_package_handle_standard_args(
    MBASE_INFERENCE
    DEFAULT_MSG
    MBASE_INFERENCE_LIBRARIES
    MBASE_INFERENCE_INCLUDE_DIRS
)

if(MBASE_INFERENCE_FOUND)
    find_package(mbase-pc HINTS ${MBASE_CURRENT_CONFIG_DIRECTORY})
    find_package(llama REQUIRED)
    
    list(APPEND MBASE_INFERENCE_LIBRARIES ${MBASE_PC_LIBRARIES})
    list(APPEND MBASE_INFERENCE_INCLUDE_DIRS ${LLAMA_INCLUDE_DIR})

    add_library(mbase.inference INTERFACE)
    target_link_libraries(mbase.inference INTERFACE ${MBASE_INFERENCE_LIBRARIES} llama)
    target_include_directories(mbase.inference INTERFACE ${MBASE_INFERENCE_INCLUDE_DIRS} llama)
    target_compile_definitions(mbase.inference INTERFACE llama)

    set_property(TARGET mbase.inference POSITION_INDEPENDENT_CODE ON)

endif()